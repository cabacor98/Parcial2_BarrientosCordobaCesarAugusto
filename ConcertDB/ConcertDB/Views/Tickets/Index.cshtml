@model IEnumerable<ConcertDB.DAL.Entities.Ticket>

@{
    ViewData["Title"] = "Index";
}

<h1>Validar Boleta</h1>

<form asp-action="ValidateTicket">
    <div class="form-group">
        <label>ID de la boleta:</label>
        <input type="text" class="form-control" name="ticketId" required>
    </div>

    <button type="submit" class="btn btn-primary">Validar</button>
</form>

@if (ViewBag.Message != null)
{
    <div class="alert alert-danger" role="alert">
        @ViewBag.Message
    </div>
}

@if (Model != null)
{
    @foreach (var ticket in Model)
    {
        <h2>Boleta válida</h2>

        <form asp-action="UseTicket">
            <div class="form-group">
                <label>Portería de ingreso:</label>
                <select class="form-control" name="entranceGate" required>
                    <option value="">-- Seleccionar --</option>
                    <option value="Norte">Norte</option>
                    <option value="Sur">Sur</option>
                    <option value="Oriental">Oriental</option>
                    <option value="Occidental">Occidental</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary">Usar Boleta</button>
        </form>

        <p>ID de la boleta: @ticket.Id</p>

        @if ((bool)ticket.IsUsed)
        {
            <p>Boleta usada a las @ticket.UseDate por la portería @ticket.EntranceGate</p>
        }
        else
        {
            <p>Boleta no usada</p>
        }
    }
}

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />

    <script>
        function showNotification(success, message) {
            var type = success ? "success" : "error";
            toastr[type](message);
        }

        $(function () {
            var message = "@ViewBag.NotificationMessage";
            var success = @ViewBag.NotificationSuccess;

            if (message) {
                showNotification(success, message);
            }
        });
    </script>
}
